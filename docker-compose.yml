version: "3"
services:
  pastebin:
    build: .
    ports:
      - "8080:8080"
    environment:
      PASTEBIN_HOST: "0.0.0.0"
      PASTEBIN_PORT: "8080"
      PASTEBIN_S3_ENDPOINT: "s3:5553"
      PASTEBIN_S3_REGION: "us-east-1"
      PASTEBIN_S3_BUCKET: "pastebin"
      PASTEBIN_S3_USE_SSL: "false"
      PASTEBIN_S3_ACCESS_KEY: "pastebin-access-key"
      PASTEBIN_S3_SECRET_KEY: "pastebin-secret-key"
      PASTEBIN_CLEANUP_INTERVAL: "1h"
      PASTEBIN_MAX_PASTE_SIZE: "1048576"
      PASTEBIN_DEFAULT_TTL: "1y"
      PASTEBIN_LOG_FORMAT: "text"
      PASTEBIN_LOG_LEVEL: "info"
    depends_on:
      - s3
    restart: unless-stopped

  s3:
    image: ghcr.io/espebra/stupid-simple-s3:latest
    environment:
      STUPID_BUCKET_NAME: "pastebin"
      STUPID_RW_ACCESS_KEY: "pastebin-access-key"
      STUPID_RW_SECRET_KEY: "pastebin-secret-key"
    volumes:
      - s3-data:/var/lib/stupid-simple-s3
    restart: unless-stopped

volumes:
  s3-data:
